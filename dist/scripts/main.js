"use strict";var app=angular.module("myApp",["ngRoute","myApp.config","myApp.filters","myApp.services","myApp.directives","myApp.controllers"]);app.config(["$routeProvider",function(e){e.when("/survey",{templateUrl:"partials/survey.html",controller:"surveyCtrl"}),e.when("/login",{templateUrl:"partials/login.html",controller:"loginCtrl"}),e.when("/demoSwipe",{templateUrl:"partials/demoSwipe.html",controller:"demoSwipeCtrl"}),e.when("/result",{templateUrl:"partials/result.html",controller:"resultCtrl",resolve:{currentAuth:["Auth",function(e){return e.$requireAuth()}]}}),e.otherwise({redirectTo:"/survey"})}]),app.run(["FBURL",function(e){"https://angularfire-survey.firebaseio.com/surveys"===e&&angular.element(document.body).html("<h1>Please configure app/js/config.js before running!</h1>")}]),app.run(["$rootScope","$location","Auth",function(e,t,n){n.$onAuth(function(t){e.authData=t}),e.logout=function(){n.$unauth(),t.path("/survey")},e.isActive=function(e){return e===t.path()},e.$on("$routeChangeError",function(e,n,r,a){"AUTH_REQUIRED"===a&&t.path("/survey")})}]);var app=angular.module("myApp.config",["ngRoute"]);app.constant("FBURL","https://ihgsurvey.firebaseio.com/surveys");var app=angular.module("myApp.services",["ngRoute","firebase"]);app.value("version","1.0.1"),app.factory("Auth",["$firebaseAuth","FBURL",function(e,t){var n=new Firebase(t);return e(n)}]);var app=angular.module("myApp.controllers",["ngRoute"]);app.controller("surveyCtrl",["$scope","FBURL","$firebaseArray",function(e,t,n){var r=new Firebase(t);e.surveys=n(r),e.timestamp=(new Date).getTime(),e.successInfo=!1,e.takeSurvey=function(){$("#tnc").modal("show"),$("#tnc").on("hidden.bs.modal",function(){$("#survey").modal("show")})},e.surveyStart=function(){},e.formData={name:"Your Name",age:"30-",colors:{red:!1,blue:!0,green:!1},lunch:!0,rating:5,comment:"Thank you.",timestamp:e.timestamp},e.updateRating=function(t){e.formData.rating=t},e.addSurvey=function(){if(e.formData.name){var t=$("#addButton").button("loading");e.surveys.$add(e.formData).then(function(){$("#survey").modal("hide"),t.button("reset"),e.successInfo=!0})}else alert("Please input the name.")}}]),app.controller("loginCtrl",["$scope","$location","Auth",function(e,t,n){e.email="admin@mydomain.com",e.password="password",e.login=function(){e.authData=null,e.error=null;var r=$("#loginButton").button("loading");n.$authWithPassword({email:e.email,password:e.password}).then(function(n){e.authData=n,t.path("/result"),r.button("reset")})["catch"](function(t){e.error=t,r.button("reset")})}}]),app.controller("resultCtrl",["$scope","FBURL","$firebaseArray",function(e,t,n){var r=new Firebase(t);e.results=n(r)}]);var app=angular.module("myApp.filters",["ngRoute"]);app.filter("interpolate",["version",function(e){return function(t){return String(t).replace(/\%VERSION\%/gm,e)}}]),angular.module("myApp.directives",["ngRoute"]).constant("buttonConfig",{activeClass:"active",toggleEvent:"click"}).directive("btnRadio",["buttonConfig",function(e){var t=e.activeClass||"active",n=e.toggleEvent||"click";return{require:"ngModel",link:function(e,r,a,o){o.$render=function(){r.toggleClass(t,angular.equals(o.$modelValue,e.$eval(a.btnRadio)))},r.bind(n,function(){r.hasClass(t)||e.$apply(function(){o.$setViewValue(e.$eval(a.btnRadio)),o.$render()})})}}}]).directive("starRating",function(){return{restrict:"A",template:"<ul class='rating'><li ng-repeat='star in stars' ng-click='toggle($index)'><span class='glyphicon' ng-class='{\"glyphicon-star\": star.filled, \"glyphicon-star-empty\": !star.filled}'></span></li></ul>",scope:{ratingValue:"=",max:"=",readonly:"@",onRatingSelected:"&"},link:function(e,t,n){var r=function(){e.stars=[];for(var t=0;t<e.max;t++)e.stars.push({filled:t<e.ratingValue})};e.toggle=function(t){e.readonly&&"true"===e.readonly||(e.ratingValue=t+1,e.onRatingSelected({rating:t+1}))},e.$watch("ratingValue",function(e,t){t&&r()})}}});